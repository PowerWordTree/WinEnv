::@author FB
::@version 0.1.0

::³õÊ¼»¯×ªÒåÐòÁÐ(ANSI Escape Sequences)
::  ²ÎÊý1: True,ÆôÓÃ(Ä¬ÈÏ); False,½ûÓÃ;
::  ·µ»Ø@: True,ÒÑÆôÓÃ; False,ÒÑ½ûÓÃ;
::  ÍË³öÂë: 0,ÒÑÆôÓÃ; 1,ÒÑ½ûÓÃ;

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

IF "%_VIRTUAL_TERMINAL_PROCESSING%" == "" (
  FOR /F "tokens=4 usebackq delims=[] " %%A IN (
    `VER 2^>NUL`
  ) DO (
    IF "%%~A" GTR "10.0.10586.0000" (
      SET "_VIRTUAL_TERMINAL_PROCESSING=Enabled"
    ) ELSE (
      SET "_VIRTUAL_TERMINAL_PROCESSING=Disabled"
    )
  )
)
IF /I NOT "%~1" == "False" IF /I "%_VIRTUAL_TERMINAL_PROCESSING%" == "Enabled" (
  CALL :@COMMON_ANSI_ESCAPE_ENABLE
  SET "@=True"
  EXIT /B 0
)
CALL :@COMMON_ANSI_ESCAPE_DISABLE
SET "@=False"
EXIT /B 1

:@COMMON_ANSI_ESCAPE_ENABLE
@SET "ANSI_ESC=?"
@SET "ANSI_CSI=[?"
@SET "ANSI_SGR=[?m"

@SET "ANSI_CURSOR_UP=[?A"
@SET "ANSI_CURSOR_DOWN=[?B"
@SET "ANSI_CURSOR_Forward=[?C"
@SET "ANSI_CURSOR_Backward=[?D"
@SET "ANSI_CURSOR_NEXT_LINE=[?E"
@SET "ANSI_CURSOR_PREVIOUS_LINE=[?F"
@SET "ANSI_CURSOR_HORIZONTAL_ABSOLUTE=[?G"
@SET "ANSI_CURSOR_VERTICALLY_ABSOLUTE=[?d"
@SET "ANSI_CURSOR_POSITION=[?H"

@SET "ANSI_ERASE_SCREEN=[?J"
@SET "ANSI_ERASE_LINE=[?K"

@SET "ANSI_POSITION_SAVE=[s"
@SET "ANSI_POSITION_LOAD=[u"

@SET "ANSI_RESET=[0m"
@SET "ANSI_LIGHT=[1m"
@SET "ANSI_FAINT=[2m"
@SET "ANSI_NORMAL=[22m"
@SET "ANSI_ITALIC=[3m"
@SET "ANSI_NO_ITALIC=[23m"
@SET "ANSI_UNDERLINE=[4m"
@SET "ANSI_NO_UNDERLINE=[24m"
@SET "ANSI_BLINK=[5m"
@SET "ANSI_NO_BLINK=[25m"
@SET "ANSI_INVERT=[7m"
@SET "ANSI_NO_INVERT=[27m"
@SET "ANSI_CROSSED=[9m"
@SET "ANSI_NO_CROSSED=[29m"

@SET "ANSI_FG_BLACK=[30m"
@SET "ANSI_FG_BRIGHT_BLACK=[90m"
@SET "ANSI_FG_RED=[31m"
@SET "ANSI_FG_BRIGHT_RED=[91m"
@SET "ANSI_FG_GREEN=[32m"
@SET "ANSI_FG_BRIGHT_GREEN=[92m"
@SET "ANSI_FG_YELLOW=[33m"
@SET "ANSI_FG_BRIGHT_YELLOW=[93m"
@SET "ANSI_FG_BLUE=[34m"
@SET "ANSI_FG_BRIGHT_BLUE=[94m"
@SET "ANSI_FG_MAGENTA=[35m"
@SET "ANSI_FG_BRIGHT_MAGENTA=[95m"
@SET "ANSI_FG_CYAN=[36m"
@SET "ANSI_FG_BRIGHT_CYAN=[96m"
@SET "ANSI_FG_WHITE=[37m"
@SET "ANSI_FG_BRIGHT_WHITE=[97m"
@SET "ANSI_FG_256_COLOR=[38;5;?m"
@SET "ANSI_FG_RGB_COLOR=[38;2;?m"
@SET "ANSI_FG_DEFAULT=[39m"

@SET "ANSI_BG_BLACK=[40m"
@SET "ANSI_BG_BRIGHT_BLACK=[100m"
@SET "ANSI_BG_RED=[41m"
@SET "ANSI_BG_BRIGHT_RED=[101m"
@SET "ANSI_BG_GREEN=[42m"
@SET "ANSI_BG_BRIGHT_GREEN=[102m"
@SET "ANSI_BG_YELLOW=[43m"
@SET "ANSI_BG_BRIGHT_YELLOW=[103m"
@SET "ANSI_BG_BLUE=[44m"
@SET "ANSI_BG_BRIGHT_BLUE=[104m"
@SET "ANSI_BG_MAGENTA=[45m"
@SET "ANSI_BG_BRIGHT_MAGENTA=[105m"
@SET "ANSI_BG_CYAN=[46m"
@SET "ANSI_BG_BRIGHT_CYAN=[106m"
@SET "ANSI_BG_WHITE=[47m"
@SET "ANSI_BG_BRIGHT_WHITE=[107m"
@SET "ANSI_BG_256_COLOR=[48;5;?m"
@SET "ANSI_BG_RGB_COLOR=[48;2;?m"
@SET "ANSI_BG_DEFAULT=[49m"
GOTO :EOF

:@COMMON_ANSI_ESCAPE_DISABLE
@SET "ANSI_ESC=^"
@SET "ANSI_CSI=^"
@SET "ANSI_SGR=^"

@SET "ANSI_CURSOR_UP=^"
@SET "ANSI_CURSOR_DOWN=^"
@SET "ANSI_CURSOR_Forward=^"
@SET "ANSI_CURSOR_Backward=^"
@SET "ANSI_CURSOR_NEXT_LINE=^"
@SET "ANSI_CURSOR_PREVIOUS_LINE=^"
@SET "ANSI_CURSOR_HORIZONTAL_ABSOLUTE=^"
@SET "ANSI_CURSOR_VERTICALLY_ABSOLUTE=^"
@SET "ANSI_CURSOR_POSITION=^"

@SET "ANSI_ERASE_SCREEN=^"
@SET "ANSI_ERASE_LINE=^"

@SET "ANSI_POSITION_SAVE=^"
@SET "ANSI_POSITION_LOAD=^"

@SET "ANSI_RESET=^"
@SET "ANSI_LIGHT=^"
@SET "ANSI_FAINT=^"
@SET "ANSI_NORMAL=^"
@SET "ANSI_ITALIC=^"
@SET "ANSI_NO_ITALIC=^"
@SET "ANSI_UNDERLINE=^"
@SET "ANSI_NO_UNDERLINE=^"
@SET "ANSI_BLINK=^"
@SET "ANSI_NO_BLINK=^"
@SET "ANSI_INVERT=^"
@SET "ANSI_NO_INVERT=^"
@SET "ANSI_CROSSED=^"
@SET "ANSI_NO_CROSSED=^"

@SET "ANSI_FG_BLACK=^"
@SET "ANSI_FG_BRIGHT_BLACK=^"
@SET "ANSI_FG_RED=^"
@SET "ANSI_FG_BRIGHT_RED=^"
@SET "ANSI_FG_GREEN=^"
@SET "ANSI_FG_BRIGHT_GREEN=^"
@SET "ANSI_FG_YELLOW=^"
@SET "ANSI_FG_BRIGHT_YELLOW=^"
@SET "ANSI_FG_BLUE=^"
@SET "ANSI_FG_BRIGHT_BLUE=^"
@SET "ANSI_FG_MAGENTA=^"
@SET "ANSI_FG_BRIGHT_MAGENTA=^"
@SET "ANSI_FG_CYAN=^"
@SET "ANSI_FG_BRIGHT_CYAN=^"
@SET "ANSI_FG_WHITE=^"
@SET "ANSI_FG_BRIGHT_WHITE=^"
@SET "ANSI_FG_256_COLOR=^"
@SET "ANSI_FG_RGB_COLOR=^"
@SET "ANSI_FG_DEFAULT=^"

@SET "ANSI_BG_BLACK=^"
@SET "ANSI_BG_BRIGHT_BLACK=^"
@SET "ANSI_BG_RED=^"
@SET "ANSI_BG_BRIGHT_RED=^"
@SET "ANSI_BG_GREEN=^"
@SET "ANSI_BG_BRIGHT_GREEN=^"
@SET "ANSI_BG_YELLOW=^"
@SET "ANSI_BG_BRIGHT_YELLOW=^"
@SET "ANSI_BG_BLUE=^"
@SET "ANSI_BG_BRIGHT_BLUE=^"
@SET "ANSI_BG_MAGENTA=^"
@SET "ANSI_BG_BRIGHT_MAGENTA=^"
@SET "ANSI_BG_CYAN=^"
@SET "ANSI_BG_BRIGHT_CYAN=^"
@SET "ANSI_BG_WHITE=^"
@SET "ANSI_BG_BRIGHT_WHITE=^"
@SET "ANSI_BG_256_COLOR=^"
@SET "ANSI_BG_RGB_COLOR=^"
@SET "ANSI_BG_DEFAULT=^"
GOTO :EOF
